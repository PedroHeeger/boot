# Forma√ß√£o Cybersec - Labs M√≥dulo 3   <img src="../0-aux/logo_boot.png" alt="boot_035" width="auto" height="45">

### Repository: [boot](../../../../)   
### Platform: <a href="../../../">vnw   <img src="https://github.com/PedroHeeger/my_tech_journey/blob/main/platforms/img/vnw.jpeg" alt="vnw" width="auto" height="25"></a>
### Software/Subject: <a href="../../">cybersecurity   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/content/cybersecurity.jpg" alt="cybersecurity" width="auto" height="25"></a>
### Bootcamp: <a href="../">boot_035 (Forma√ß√£o Cybersec)   <img src="../0-aux/logo_boot.png" alt="boot_035" width="auto" height="25"></a>
### Module: 3. Ethical Hacking (Red Team)

#### <a href="./README.md">Teoria</a>

---

Esta pasta refere-se aos laborat√≥rios do m√≥dulo 3 **Ethical Hacking (Red Team)** do bootcamp [**Forma√ß√£o Cybersec**](../).

### Theme:
- Cybersecurity

### Used Tools:
- Operating System (OS): 
  - Linux   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/linux/linux-original.svg" alt="linux" width="auto" height="25">
  - Windows 11   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/windows11.png" alt="windows11" width="auto" height="25">
- Linux Distribution:
  - Ubuntu   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/ubuntu/ubuntu-plain.svg" alt="ubuntu" width="auto" height="25">
- Cloud:
  - AWS   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/amazonwebservices/amazonwebservices-original-wordmark.svg" alt="aws" width="auto" height="25">
- Cloud Services:
  - Amazon Elastic Compute Cloud (EC2)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/cloud/aws_ec2.svg" alt="aws_ec2" width="auto" height="25">
  - Google Drive   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/google_drive.png" alt="google_drive" width="auto" height="25">
- Containerization: 
  - Docker   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/docker/docker-original.svg" alt="docker" width="auto" height="25">
  - Docker Compose   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/docker_compose.png" alt="docker_compose" width="auto" height="25">
  - Docker Playground; Play With Docker (PWD)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/sites/docker_playground.jpg" alt="docker_playground" width="auto" height="25">
- Build Automation:
  - Make   <img src="" alt="make" width="auto" height="25">
- Language:
  - HTML   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/html5/html5-original.svg" alt="html" width="auto" height="25">
  - Markdown   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/markdown/markdown-original.svg" alt="markdown" width="auto" height="25">
- Integrated Development Environment (IDE) and Text Editor:
  - Nano   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/nano.png" alt="nano" width="auto" height="25">
  - Vi   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/vi.png" alt="vi" width="auto" height="25">
  - VI iMproved (Vim)   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vim/vim-original.svg" alt="vim" width="auto" height="25">
  - Visual Studio Code (VS Code)   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vscode/vscode-original.svg" alt="vscode" width="auto" height="25">
- Versioning: 
  - Git   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/git/git-original.svg" alt="git" width="auto" height="25">
- Repository:
  - GitHub   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" alt="github" width="auto" height="25">
- Command Line Interpreter (CLI):
  - AWS Command Line Interface (CLI)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/cloud/aws_cli.svg" alt="aws_cli" width="auto" height="25">
  - Bash e Sh   <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/bash/bash-original.svg" alt="bash_sh" width="auto" height="25">
- Tools:
  - Advanced Package Tool (Apt)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/apt.png" alt="apt" width="auto" height="25">
  - Advanced Package Tool (Apt-Get)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/apt-get.jpg" alt="apt-get" width="auto" height="25">
  - Curl   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/curl.png" alt="curl" width="auto" height="25">
- Network:
  - netstat   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/netstat.webp" alt="netstat" width="auto" height="25">
  - Nmap   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/nmap.png" alt="nmap" width="auto" height="25">
  - OpenSSH   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/openssh.png" alt="openssh" width="auto" height="25">
  - OWASP Juice Shop   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/sites/owasp_juice_shop.png" alt="owasp_juice_shop" width="auto" height="25">
  - OWASP ModSecurity Core Rule Set (OWASP ModSecurity CRS)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/owasp_modesecurity_crs.png" alt="owasp_modesecurity_crs" width="auto" height="25">
  - Uncomplicated Firewall (UFW)   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/ufw.webp" alt="ufw" width="auto" height="25">
- Remote Desktop:
  - RealVNC Viewer   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/realvnc.png" alt="realvnc_viewer" width="auto" height="25">
- Cibersecurity:
  - Docker Bench for Security   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/docker_bench_for_security.png" alt="docker_bench_for_security" width="auto" height="25">
  - Kali Linux   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/kali_linux.png" alt="kali_linux" width="auto" height="25">
  - Sqlmap   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/sqlmap.png" alt="sqlmap" width="auto" height="25">
  - Trivy   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/trivy.png" alt="trivy" width="auto" height="25">
- SysAdm:
  - Xfce   <img src="https://github.com/PedroHeeger/main/blob/main/0-aux/logos/software/xfce.svg" alt="xfce" width="auto" height="25">

---

### Bootcamp Module 3 Structure:
3. <a name="item3">M√≥dulo 3: Ethical Hacking (Red Team)<br>
  3.1 <a href="#item3.1">Pentest: Metodologia & Regras de Engajamento</a><br>
  3.2 <a href="#item3.2">Hardening de Servidores Linux</a><br>
  3.3 <a href="#item3.3">Firewall & ACL</a><br>
  3.4 <a href="#item3.4">IDS e IPS</a><br>
  3.5 <a href="#item3.5">Monitoramento de Logs</a><br>
  3.6 <a href="#item3.6">Patch Management</a><br>
  3.7 <a href="#item3.7">Cloud Security</a><br>
  3.8 <a href="#item3.8">IAM e Permissionamento</a><br>
  3.9 <a href="#item3.9">Container Security Docker Bench & Trivy</a><br>
  3.10 <a href="#item3.10">NIST & Resposta a Incidentes</a><br>

---

### Objective:
Desenvolver a mentalidade ofensiva necess√°ria para simular ataques reais e transformar descobertas em evid√™ncias t√©cnicas e recomenda√ß√µes acion√°veis, por meio da aplica√ß√£o de metodologias de pentest, explora√ß√£o de vulnerabilidades com ferramentas como **Metasploit** e **Burp Suite**, t√©cnicas de quebra de credenciais, escalonamento de privil√©gios em **Linux** e **Windows**, movimenta√ß√£o lateral, evas√£o de controles de defesa e elabora√ß√£o de relat√≥rios t√©cnicos profissionais.

### Folder Structure:
- [README.md](./README.md): Documento escrito em **Markdown** descrevendo todo conte√∫do te√≥rico realizado neste m√≥dulo.
- [labs.md](./labs.md): Este documento de README, escrito em **Markdown**, descrevendo todos os laborat√≥rios realizados neste m√≥dulo.

### Development:
Em ciberseguran√ßa, √© pr√°tica comum e recomendada realizar laborat√≥rios em ambientes controlados e seguros. Por isso, ferramentas como **Docker** ou m√°quinas virtuais s√£o utilizadas para simular ambientes reais, protegendo a infraestrutura local, uma vez que o uso de ferramentas de ataque ou altera√ß√µes em configura√ß√µes de rede podem comprometer a integridade do sistema. O ambiente de laborat√≥rio √© estruturado em duas partes: a primeira envolve a instala√ß√£o dos softwares que virtualiza√ß√£o um ambiente, como **WSL2**, **Docker** ou **VM VirtualBox**, al√©m de ferramentas de suporte essenciais, como editores de c√≥digo (**Visual Studio Code (VS Code)**) e sistemas de versionamento (**Git**).  

Neste curso, a virtualiza√ß√£o do ambiente foi realizada principalmente com **Docker** em conjunto com **WSL**. No entanto, para a maioria dos labs utilizei o **Docker** em inst√¢ncias do **Amazon Elastic Compute Cloud (EC2)**, na nuvem da **Amazon Web Services (AWS)**, como alternativa de execu√ß√£o. Em pequenos casos, para realizar testes, a plataforma **Play With Docker (PWD)** tamb√©m foi utilizada.

A cria√ß√£o da inst√¢ncia EC2 foi automatizada por meio do script [`ec2Instance.ps1`](../environment/ec2Instance.ps1), desenvolvido em **Windows PowerShell** utilizando comandos da **AWS Command Line Interface (CLI)**. O script est√° localizado na pasta [`environment`](../environment/) deste curso, pois foi o mesmo para todos os m√≥dulos. A inst√¢ncia foi provisionada com a imagem `ami-020cba7c55df1f615`, baseada no sistema operacional **Linux Ubuntu**, associada a um volume do **Amazon Elastic Block Store (EBS)** de `8 GB`, do tipo `gp` (General Purpose). O tipo de inst√¢ncia utilizado foi o `t3.medium`, com 2 vCPUs e 4 GB de mem√≥ria. Para acesso, foi utilizado o par de chaves `keyPairUniversal`, previamente existente na conta da **AWS**, e o grupo de seguran√ßa atribu√≠do √† inst√¢ncia foi o `default` da zona de disponibilidade `us-east-1a` (Norte da Virg√≠nia). Um script de *user data* foi utilizado para automatizar a instala√ß√£o do **Git** e do **Docker** durante o processo de inicializa√ß√£o.

O acesso √† inst√¢ncia podia ser feito tanto pelo console da **AWS** quanto por meio de conex√£o SSH utilizando o **OpenSSH** no **Windows PowerShell** da m√°quina local. Neste √∫ltimo caso, era necess√°rio informar o caminho do arquivo de chave privada, o nome do usu√°rio do sistema e o IP ou DNS p√∫blico da inst√¢ncia. Um exemplo de comando seria: `ssh -i "G:/Meu Drive/4_PROJ/scripts/aws/.default/secrets/awsKeyPair/universal/keyPairUniversal.pem" ubuntu@54.160.249.118`. Al√©m disso, o Security Group associado √† inst√¢ncia precisava conter uma regra de entrada liberando a porta `22` para o IP p√∫blico da m√°quina f√≠sica, a fim de permitir o estabelecimento da conex√£o SSH. As m√°quinas virtuais do **Play With Docker (PWD)** tamb√©m foram acessadas via SSH. Nesse caso, o pr√≥prio ambiente fornecia o comando necess√°rio para a conex√£o, que podia ser executado diretamente no **Windows PowerShell**, sem necessidade de autentica√ß√£o com chave privada ou senha.

A segunda parte do ambiente de laborat√≥rio consiste na constru√ß√£o do ambiente simulado propriamente dito. No caso do **Docker**, isso envolve a cria√ß√£o de containers, redes e volumes, realizada por meio de dois tipos principais de arquivos. O primeiro √© o `docker-compose.yml`, que define de forma serial toda a estrutura a ser criada: quais e quantos containers, suas configura√ß√µes, as imagens que ir√£o utilizar e os volumes e redes que ser√£o estabelecidos. O segundo tipo de arquivo, que pode existir mais de um por laborat√≥rio, s√£o os `Dockerfile`, respons√°veis por criar imagens espec√≠ficas para cada container. Essas imagens podem ser enviadas a reposit√≥rios de imagens **Docker**, como o **DockerHub**, ou referenciadas diretamente no arquivo do **Docker Compose**.

Todos esses arquivos eram preparados pelo instrutor do curso e disponibilizados no [reposit√≥rio](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/) do curso no perfil da plataforma **Vai na Web** no **GitHub**. O reposit√≥rio era organizado pelos tr√™s m√≥dulos do curso, com pastas correspondentes a cada laborat√≥rio. Geralmente, o n√∫mero do laborat√≥rio coincidia com o n√∫mero da aula, embora nem todos os labs seguissem essa sequ√™ncia e nem todas as aulas tivessem laborat√≥rios. Em cada pasta de laborat√≥rio, al√©m dos arquivos `docker-compose.yml` e `Dockerfile`, podiam existir arquivos complementares, como scripts, textos ou documentos **Markdown**, contendo informa√ß√µes relevantes ou conte√∫dos necess√°rios para a execu√ß√£o do lab. Durante a realiza√ß√£o de cada lab, al√©m de executar os exerc√≠cios, foi feita uma explica√ß√£o detalhada sobre a constru√ß√£o dos arquivos de **Docker Compose**,  **Docker** e as depend√™ncias utilizadas, evidenciando como o ambiente foi estruturado.

Para executar os arquivos e iniciar o ambiente de laborat√≥rio, a sequ√™ncia de comandos utilizada era a seguinte:
- `git clone https://github.com/Kensei-CyberSec-Lab/formacao-cybersec.git`: Clonagem do reposit√≥rio do bootcamp para o ambiente local, seja no **WSL**, em m√°quinas virtuais ou, como no meu caso, em inst√¢ncias **Amazon EC2**.
- `cd formacao-cybersec/modulo3-ethical-hacking/lab_1`: Navega√ß√£o at√© o diret√≥rio do laborat√≥rio a ser executado. Para outros labs, bastava alterar as duas √∫ltimas pastas do caminho para o m√≥dulo e lab correspondentes.
- `docker compose up -d`: Inicializa√ß√£o do ambiente com **Docker Compose**. Este comando devia ser executado na pasta onde o arquivo `docker-compose.yml` estava localizado.
- `docker ps` e `docker network ls`: Verifica√ß√£o dos containers ativos e das redes existentes no ambiente.
- `docker exec -it kali /bin/bash`: Acesso a um container em execu√ß√£o. Bastava substituir `kali` pelo nome do container que desejava-se acessar.
- `docker compose down`: Encerramento do ambiente. Assim como na inicializa√ß√£o, este comando devia ser executado na pasta onde se encontrava o arquivo `docker-compose.yml`.
- `docker system prune -f`: Remo√ß√£o containers parados, redes n√£o usadas, imagens dangling (imagens sem tags) e caches de build.
- `docker system prune -a`: Remo√ß√£o containers parados, redes n√£o usadas, imagens dangling (imagens sem tags) e caches de build, al√©m de remo√ß√£o de todas as imagens n√£o usadas por containers.

Os laborat√≥rios de ciberseguran√ßa s√£o organizados com m√°quinas de ataque, geralmente uma **Kali Linux**, e m√°quinas alvo ou de defesa, que s√£o os sistemas onde os ataques s√£o realizados. Pode haver m√∫ltiplas m√°quinas de cada tipo, sendo comum que algumas m√°quinas de defesa sejam propositalmente vulner√°veis, incluindo aplica√ß√µes web criadas para testes. Como o ambiente √© simulado via **Docker**, termos como servidor, m√°quina, container ou host frequentemente se referem aos containers que representam as m√°quinas simuladas. Al√©m disso, √© importante ter em mente que existiam outras duas camadas no ambiente: a m√°quina f√≠sica, no caso meu computador pessoal **Windows**, e a m√°quina virtual fornecida pela **AWS** ou pelo **Play With Docker (PWD)**, que hospedava e executava os containers do **Docker**.

Outra parte importante dos laborat√≥rios foram os *Capture The Flag (CTF)*, desafios t√©cnicos amplamente utilizados na √°rea de ciberseguran√ßa para desenvolver e validar conhecimento pr√°tico. Cada desafio apresenta um cen√°rio espec√≠fico ‚Äî como explora√ß√£o de vulnerabilidades, an√°lise de tr√°fego, OSINT ou engenharia reversa ‚Äî e exige que o participante realize uma a√ß√£o ou resolva um problema para obter a flag. A flag n√£o se limita a uma string ou c√≥digo a ser encontrado, ela representa a prova de que o objetivo do desafio foi cumprido com sucesso. Ao longo dos laborat√≥rios do curso, diversos CTFs foram incorporados ao ambiente simulado, servindo como etapas pr√°ticas de valida√ß√£o do conte√∫do e permitindo aplicar, de forma objetiva, os conceitos aprendidos. Dessa forma, os laborat√≥rios n√£o apenas simularam cen√°rios reais de ataque e defesa, como tamb√©m proporcionaram desafios progressivos que refor√ßaram o racioc√≠nio l√≥gico, a an√°lise t√©cnica e a consolida√ß√£o do conhecimento.

<a name="item3.1"><h4>3.1 Pentest: Metodologia & Regras de Engajamento</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_1)

Obs.: Laborat√≥rio registrado como 1, documento como 1 e referente a aula 1.

<details><summary><strong>Ambiente de Laborat√≥rio</strong></summary>
  <ul>
    <li><details><summary><strong>Docker Compose</strong></summary>
        <ul>
          <li><details><summary><strong>services:</strong></summary>
            <ul>
              <li><details><summary><strong>kali:</strong></summary>
                <ul>
                  <li><strong>build:</strong>
                    <ul>
                      <li><code>context: .</code>: Contexto da build √© o diret√≥rio atual.</li>
                      <li><code>dockerfile: kali.Dockerfile</code>: Usa o arquivo <code>kali.Dockerfile</code> para construir a imagem.</li>
                    </ul>
                  </li>
                  <li><strong>container_name:</strong> Define o nome do container como <code>kensei_kali</code>.</li>
                  <li><code>tty: true</code>: Permite alocar um terminal interativo para o container.</li>
                  <li><code>stdin_open: true</code>: Mant√©m o STDIN aberto para uso com <code>docker exec -it</code>.</li>
                  <li><strong>volumes:</strong>
                    <ul>
                      <li><code>- ./labs:/home/kali/labs</code>: Monta o diret√≥rio local <code>./labs</code> dentro do container em <code>/home/kali/labs</code>, facilitando desenvolvimento e uso de scripts.</li>
                    </ul>
                  </li>
                  <li><strong>command:</strong> <code>/bin/bash</code>: Inicia o shell Bash, mantendo o container pronto para uso.</li>
                </ul>
              </details></li>
              <li><details><summary><strong>spiderfoot:</strong></summary>
                <ul>
                  <li><strong>build:</strong>
                    <ul>
                      <li><code>context: .</code>: Define o diret√≥rio atual como contexto da build.</li>
                      <li><code>dockerfile: Dockerfile.spiderfoot</code>: Usa o Dockerfile dedicado do SpiderFoot para construir a imagem.</li>
                    </ul>
                  </li>
                  <li><strong>container_name:</strong> Define o nome do container como <code>kensei_spiderfoot</code>.</li>
                  <li><strong>ports:</strong>
                    <ul>
                      <li><code>"5001:5001"</code>: Exp√µe a interface web do SpiderFoot na porta 5001 do host.</li>
                    </ul>
                  </li>
                  <li><strong>volumes:</strong>
                    <ul>
                      <li><code>- ./spiderfoot-data:/root/.spiderfoot</code>: Monta o diret√≥rio local <code>./spiderfoot-data</code> dentro do container em <code>/root/.spiderfoot</code>, garantindo que configura√ß√µes, resultados e dados do SpiderFoot sejam persistidos entre reinicializa√ß√µes do container.</li>
                    </ul>
                  </li>
                </ul>
              </details></li>
              <li><details><summary><strong>neo4j:</strong></summary>
                <ul>
                  <li><strong>image:</strong> Usa a imagem oficial <code>neo4j:4.4</code>.</li>
                  <li><strong>container_name:</strong> Define o nome do container como <code>kensei_neo4j</code>.</li>
                  <li><strong>environment:</strong>
                    <ul>
                      <li><code>NEO4J_AUTH=neo4j/test</code>: Define usu√°rio e senha iniciais (<code>neo4j</code> / <code>test</code>).</li>
                      <li><code>NEO4J_dbms_memory_heap_initial__size=512m</code>: Define o tamanho inicial do heap de mem√≥ria do Neo4j como 512 MB.</li>
                      <li><code>NEO4J_dbms_memory_heap_max__size=1g</code>: Define o tamanho m√°ximo do heap de mem√≥ria do Neo4j como 1 GB.</li>
                    </ul>
                  </li>
                  <li><strong>ports:</strong>
                    <ul>
                      <li><code>"7474:7474"</code>: Mapeia a porta 7474 do container para a porta 7474 do host, permitindo acesso √† interface web do Neo4j via navegador.</li>
                      <li><code>"7687:7687"</code>: Mapeia a porta 7687 do container para a porta 7687 do host, utilizada pelo Bolt protocol para conex√£o de drivers e aplica√ß√µes ao Neo4j.</li>
                    </ul>
                  </li>
                  <li><strong>volumes:</strong>
                    <ul>
                      <li><code>- ./neo4j-data:/data</code>: Monta o diret√≥rio local <code>./neo4j-data</code> dentro do container em <code>/data</code>, garantindo que o banco de dados Neo4j seja persistido no host entre reinicializa√ß√µes do container.</li>
                    </ul>
                  </li>
                </ul>
              </details></li>
            </ul>
          </details></li>
          <li><details><summary><strong>networks:</strong></summary>
            <ul>
              <li><code>default:</code>
                <ul>
                  <li><strong>name:</strong> <code>kensei_lab_net</code>: Nomeia a rede padr√£o usada pelos servi√ßos, garantindo comunica√ß√£o entre containers dentro dessa rede.</li>
                </ul>
              </li>
            </ul>
          </details></li>
        </ul>
      </details></li>
    <li><details><summary><strong>Dockerfile</strong></summary>
      <ul>
        <li><details><summary><strong>Dockerfile.kali</strong></summary>
          <ul>
            <li><code>FROM kalilinux/kali-rolling</code>: Imagem base Kali Rolling.</li>
            <li><strong>RUN:</strong> Executa a instala√ß√£o de ferramentas essenciais e limpa o cache para reduzir o tamanho da imagem:
              <ul>
                <li><code>apt-get update</code>: Atualiza a lista de pacotes dispon√≠veis.</li>
                <li><code>apt-get install -y git curl jq python3-pip build-essential golang-go amass</code>: Instala ferramentas essenciais de desenvolvimento, rede e pentest.</li>
                <li><code>apt-get clean && rm -rf /var/lib/apt/lists/*</code>: Remove arquivos tempor√°rios e limpa cache do apt.</li>
              </ul>
            </li>
            <li><code>ENV GOPATH=/root/go</code>: Define a vari√°vel <code>GOPATH</code> apontando para <code>/root/go</code>, diret√≥rio onde o Go instalar√° pacotes e bin√°rios do usu√°rio.</li>
            <li><code>ENV PATH=$PATH:/root/go/bin</code>: Adiciona <code>/root/go/bin</code> ao <code>PATH</code>, permitindo executar ferramentas instaladas via <code>go install</code>.</li>
            <li><code>RUN mkdir -p $GOPATH</code>: Cria diret√≥rio do GOPATH.</li>
            <li><strong>RUN:</strong> Instala ferramentas Go no <code>GOPATH</code> utilizando <code>go install ...@latest</code> e disponibiliza os bin√°rios em <code>/root/go/bin</code>:
              <ul>
                <li><code>go install github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest</code>: Instala o <strong>subfinder</strong>, usado para descoberta de subdom√≠nios.</li>
                <li><code>go install github.com/projectdiscovery/httpx/cmd/httpx@latest</code>: Instala o <strong>httpx</strong>, utilizado para verifica√ß√£o e coleta de informa√ß√µes HTTP (status, headers, t√≠tulos, etc.).</li>
                <li><code>go install github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest</code>: Instala o <strong>nuclei</strong>, motor de scan de vulnerabilidades baseado em templates.</li>
                <li><code>go install github.com/hakluke/hakrawler@latest</code>: Instala o <strong>hakrawler</strong>, um crawler r√°pido para descoberta de endpoints e conte√∫do web.</li>
                <li><code>go install github.com/zricethezav/gitleaks/v8@latest</code>: Instala o <strong>gitleaks</strong>, ferramenta para detec√ß√£o de segredos e chaves em reposit√≥rios.</li>
              </ul>
            </li>
            <li><code>COPY scripts /home/kali/scripts</code>: Copia scripts locais para dentro do container.</li>
            <li><code>WORKDIR /home/kali</code>: Define diret√≥rio de trabalho.</li>
            <li><code>CMD ["/bin/bash"]</code>: Inicia o shell Bash.</li>
          </ul>
        </details></li>
        <li><details><summary><strong>Dockerfile.spiderfoot</strong></summary>
          <ul>
            <li><code>FROM python:3.10-slim</code>: Usa a imagem base Python 3.10 slim como ambiente inicial.</li>
            <li><strong>RUN</strong>:
              <ul>
                <li><code>apt-get update</code>: Atualiza a lista de pacotes.</li>
                <li><code>apt-get install -y --no-install-recommends git build-essential python3-dev libyaml-dev curl ca-certificates gcc g++ make libffi-dev libssl-dev</code>: Instala depend√™ncias do sistema necess√°rias para compilar e executar as depend√™ncias Python do SpiderFoot.</li>
                <li><code>rm -rf /var/lib/apt/lists/*</code>: Remove listas de pacotes para reduzir o tamanho final da imagem.</li>
              </ul>
            </li>
            <li><code>RUN pip3 install -U pip setuptools wheel cython</code>: Atualiza o gerenciador de pacotes Python e instala ferramentas de build (necess√°rias para compilar extens√µes como PyYAML).</li>
            <li><code>WORKDIR /app</code>: Define o diret√≥rio de trabalho para os comandos seguintes.</li>
            <li><code>RUN git clone --depth=1 --branch v4.0 https://github.com/smicallef/spiderfoot /app</code>: Clona a vers√£o 4.0 do reposit√≥rio SpiderFoot diretamente para <code>/app</code>.</li>
            <li><code>RUN sed -i 's/pyyaml>=5.4.1,<6/pyyaml>=6.0/' requirements.txt</code>: Altera a especifica√ß√£o do PyYAML no <code>requirements.txt</code> para uma vers√£o compat√≠vel (quando necess√°rio) antes da instala√ß√£o das depend√™ncias.</li>
            <li><code>RUN pip3 install -r requirements.txt</code>: Instala as depend√™ncias Python do SpiderFoot listadas em <code>requirements.txt</code>.</li>
            <li><code>EXPOSE 5001</code>: Exp√µe a porta 5001, usada pela interface web do SpiderFoot.</li>
            <li><code>CMD ["python3", "sf.py", "-l", "0.0.0.0:5001"]</code>: Comando padr√£o para iniciar o SpiderFoot, fazendo-o escutar em todas as interfaces na porta 5001.</li>
          </ul>
        </details></li>
      </ul>
    </details></li>
  </ul>
</details>

O primeiro laborat√≥rio desse curso consistiu em executar um pentest em uma sistema vulneravel de uma empresa fict√≠cia de nome Acme Corp, passando por v√°rias etapas: reconhecimento, descoberta, explora√ß√£o, enumera√ß√£o, an√°lise avan√ßada, documenta√ß√£o. Esse sistma foi constru√≠do na **AWS** pelo instrutor do curso e teve seu acesso controlado apenas aos alunos do curso, evitando assim que 

O ambiente **Docker** foi implantado em uma inst√¢ncia **Amazon EC2** na **AWS** e √© composto pelos tr√™s containers seguintes:
- `kensei_kali`: Kali Linux utilizado para ataque e reconhecimento. Cont√©m ferramentas como **Subfinder**, **Httpx**, **Nuclei**, **Hakrawler**, **Gitleaks**, al√©m de softwares como: **Python**, **curl**, **git**, **jq**, **build-essential**, **Golang** e **Amass**.
- `kensei_spiderfoot`: container executando o **SpiderFoot**.
- `kensei_neo4j`: container executando o **Neo4j**.

Antes de iniciar a primeira etapa, o reconhecimento, foi realizado o acesso ao container **Kali Linux** a partir da inst√¢ncia remota, utilizando o comando `docker exec -it kensei_kali /bin/bash`. Dentro do container, foi criada a pasta de trabalho `acme-corp` com `mkdir -p /home/kali/investigations/acme-corp` e em seguida acessado o diret√≥rio com `cd /home/kali/investigations/acme-corp`.

üîç Fase 1 ‚Äî Reconhecimento   
Na Fase 1, o objetivo foi enumerar todos os subdom√≠nios associados ao dom√≠nio da Acme Corp (`acme-corp-lab.com`). A partir da m√°quina de ataque, acessada no container Kali, foi executado o **Subfinder** com o comando `subfinder -d acme-corp-lab.com -o subdomains.txt`, que coletou os subdom√≠nios e salvou o resultado no arquivo `subdomains.txt`, dentro do diret√≥rio criado `/home/kali/investigations/acme-corp`. Em seguida, verificou‚Äëse o conte√∫do gerado com `cat /home/kali/investigations/acme-corp/subdomains.txt` para confirmar os subdom√≠nios encontrados, conforme ilustrado na imagem 01.

<div align="center"><figure>
    <img src="../0-aux/md3-img01.png" alt="img01"><br>
    <figcaption>Imagem 01.</figcaption>
</figure></div><br>

Um dos subdom√≠nios identificados apresentava o prefixo `old`, indicando tratar‚Äëse de um sistema legado ‚Äî normalmente mais suscet√≠vel a vulnerabilidades. Em seguida, executou‚Äëse o **Amass** com tempo limitado para execu√ß√£o usando: `timeout 300 amass enum -passive -d acme-corp-lab.com -o amass_results.txt -v || echo "Amass timeout - continuando com Subfinder"`, de modo que quaisquer resultados fossem gravados em `amass_results.txt`. Por fim, verificou‚Äëse o conte√∫do retornado pelo Amass com o comando abaixo.

```bash
if [ -f amass_results.txt ]; then
    echo "=== RESULTADOS DO AMASS ==="
    cat amass_results.txt
else
    echo "Amass n√£o completou - usando apenas resultados do Subfinder"
fi
```

O **Amass** demorou muito e n√£o trouxe novas descobertas; por isso, foram utilizados apenas os resultados do **Subfinder**. Como alguns subdom√≠nios poderiam n√£o estar ativos, foi necess√°rio verificar quais dos quatro listados respondiam. Para isso, executou-se o comando `cat subdomains.txt | dnsx -resp -silent -o resolved_subdomains.txt`, que consultou cada subdom√≠nio e salvou as entradas resolvidas em `resolved_subdomains.txt`. Os resultados, conforme imagem 02, indicaram que todos os subdom√≠nios resolviam para endere√ßos IP distintos ‚Äî situa√ß√£o que pode indicar uma infraestrutura distribu√≠da ou a presen√ßa de balanceamento de carga.

<div align="center"><figure>
    <img src="../0-aux/md3-img02.png" alt="img02"><br>
    <figcaption>Imagem 02.</figcaption>
</figure></div><br>

Na sequ√™ncia, foi utilizado o **httpx** para identificar os servi√ßos expostos por cada subdom√≠nio. O comando executado foi: `cat subdomains.txt | httpx -title -tech-detect -status-code -o live_web_services.txt`. Esse comando consultou cada subdom√≠nio e gerou um relat√≥rio contendo o t√≠tulo da p√°gina, as tecnologias detectadas e o c√≥digo de status HTTP, salvando todas as informa√ß√µes em `live_web_services.txt`. Ao verificar o conte√∫do do arquivo com `cat live_web_services.txt`, conforme mostrado na imagem 03, foram obtidos os seguintes resultados:
- `www.acme-corp-lab.com`: site est√°tico hospedado no **Amazon S3**, t√≠pico para o site principal.
- `admin.acme-corp-lab.com`: painel **WordPress**, alvo comum em testes de seguran√ßa a pain√©is administrativos.
- `old.acme-corp-lab.com`: retornou HTTP 301, indicando um redirecionamento.

<div align="center"><figure>
    <img src="../0-aux/md3-img03.png" alt="img03"><br>
    <figcaption>Imagem 03.</figcaption>
</figure></div><br>

üéØ Fase 2: - Descoberta   
Na fase de descoberta, foi realizado uma investiga√ß√£o aprofundada do subdom√≠nio `old`, que era um redirecionamento. Muitas vezes redirecionamentos revelam informa√ß√µes interessantes. Dessa forma, foi executado o comando `curl -L -s http://old.acme-corp-lab.com/ > legacy_page.html` para seguir todos os redirecionamentos e na p√°gina final copiar o HTML dela para o arquivo `legacy_page.html`.








<a name="item3.2"><h4>3.2 Hardening de Servidores Linux</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_2)






<a name="item3.3"><h4>3.3 Firewall & ACL</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_3)






<a name="item3.4"><h4>3.4 IDS e IPS</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking)

A aula 4 n√£o teve nenhum laborat√≥rio ou o laborat√≥rio ainda n√£o foi constru√≠do pelo professor do curso.


<a name="item3.5"><h4>3.5 Monitoramento de Logs</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking)

A aula 5 n√£o teve nenhum laborat√≥rio ou o laborat√≥rio ainda n√£o foi constru√≠do pelo professor do curso.

<a name="item3.6"><h4>3.6 Patch Management</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_4)






<a name="item3.7"><h4>3.7 Cloud Security</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_7)

A aula 7 n√£o teve nenhum laborat√≥rio ou o laborat√≥rio ainda n√£o foi constru√≠do pelo professor do curso.

<a name="item3.8"><h4>3.8 IAM e Permissionamento</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_8)

A aula 8 n√£o teve nenhum laborat√≥rio ou o laborat√≥rio ainda n√£o foi constru√≠do pelo professor do curso.


<a name="item3.9"><h4>3.9 Container Security Docker Bench & Trivy</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_5)








<a name="item3.10"><h4>3.10 NIST & Resposta a Incidentes</h4></a>[Back to summary](#item3)   
[Material do Lab](https://github.com/Kensei-CyberSec-Lab/formacao-cybersec/tree/main/modulo3-ethical-hacking/lab_6)
